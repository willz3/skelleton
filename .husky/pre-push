#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸš€ Executando validaÃ§Ãµes completas antes do push..."
echo "â³ Isso pode levar alguns minutos..."

# 1. VerificaÃ§Ã£o de tipos TypeScript
echo "ğŸ” 1/3 - Verificando tipos TypeScript..."
if npx tsc --noEmit; then
  echo "âœ… VerificaÃ§Ã£o de tipos passou!"
else
  echo "âŒ Erros de tipo encontrados. Push cancelado."
  echo "ğŸ’¡ Corrija os erros de TypeScript antes de fazer o push."
  exit 1
fi

# 2. Lint (ESLint)
echo "ğŸ§¹ 2/3 - Executando lint..."
if npm run lint; then
  echo "âœ… Lint passou!"
else
  echo "âŒ Problemas de lint encontrados. Push cancelado."
  echo "ğŸ’¡ Corrija os problemas de lint antes de fazer o push."
  exit 1
fi

# 3. Todos os testes
echo "ğŸ§ª 3/3 - Executando todos os testes..."
if npm test; then
  echo "âœ… Todos os testes passaram!"
else
  echo "âŒ Alguns testes falharam. Push cancelado."
  echo "ğŸ’¡ Corrija os testes que falharam antes de fazer o push."
  exit 1
fi

echo ""
echo "ğŸ‰ Todas as validaÃ§Ãµes passaram!"
echo "âœ… Tipos TypeScript vÃ¡lidos"
echo "âœ… Lint sem problemas" 
echo "âœ… Todos os testes passando"
echo "" 